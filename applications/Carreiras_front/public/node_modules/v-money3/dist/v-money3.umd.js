(function(l,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],a):(l=typeof globalThis<"u"?globalThis:l||self,a(l["v-money3"]={},l.Vue))})(this,function(l,a){"use strict";var ee=Object.defineProperty;var te=(l,a,o)=>a in l?ee(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o;var C=(l,a,o)=>(te(l,typeof a!="symbol"?a+"":a,o),o);const o={debug:!1,masked:!1,prefix:"",suffix:"",thousands:",",decimal:".",precision:2,disableNegative:!1,disabled:!1,min:null,max:null,allowBlank:!1,minimumNumberOfCharacters:0,modelModifiers:{number:!1},shouldRound:!0,focusOnRight:!1},M=["+","-"],O=["decimal","thousands","prefix","suffix"];function m(t){return Math.max(0,Math.min(t,1e3))}function p(t,e){return t=t.padStart(e+1,"0"),e===0?t:`${t.slice(0,-e)}.${t.slice(-e)}`}function E(t){return t=t?t.toString():"",t.replace(/\D+/g,"")||"0"}function H(t,e){return t.replace(/(\d)(?=(?:\d{3})+\b)/gm,`$1${e}`)}function K(t,e,n){return e?t+n+e:t}function y(t,e){return M.includes(t)?(console.warn(`v-money3 "${e}" property don't accept "${t}" as a value.`),!1):/\d/g.test(t)?(console.warn(`v-money3 "${e}" property don't accept "${t}" (any number) as a value.`),!1):!0}function W(t){for(const e of O)if(!y(t[e],e))return!1;return!0}function w(t){for(const e of O){t[e]=t[e].replace(/\d+/g,"");for(const n of M)t[e]=t[e].replaceAll(n,"")}return t}function V(t){const e=t.length,n=t.indexOf(".");return e-(n+1)}function $(t){return t.replace(/^(-?)0+(?!\.)(.+)/,"$1$2")}function F(t){return/^-?[\d]+$/g.test(t)}function I(t){return/^-?[\d]+(\.[\d]+)$/g.test(t)}function D(t,e,n){return e>t.length-1?t:t.substring(0,e)+n+t.substring(e+1)}function A(t,e){const n=e-V(t);if(n>=0)return t;let i=t.slice(0,n);const s=t.slice(n);if(i.charAt(i.length-1)==="."&&(i=i.slice(0,-1)),parseInt(s.charAt(0),10)>=5){for(let u=i.length-1;u>=0;u-=1){const c=i.charAt(u);if(c!=="."&&c!=="-"){const d=parseInt(c,10)+1;if(d<10)return D(i,u,d);i=D(i,u,"0")}}return`1${i}`}return i}function P(t,e){const n=()=>{t.setSelectionRange(e,e)};t===document.activeElement&&(n(),setTimeout(n,1))}function _(t){return new Event(t,{bubbles:!0,cancelable:!1})}function r({debug:t=!1},...e){t&&console.log(...e)}class N{constructor(e){C(this,"number",0n);C(this,"decimal",0);this.setNumber(e)}getNumber(){return this.number}getDecimalPrecision(){return this.decimal}setNumber(e){this.decimal=0,typeof e=="bigint"?this.number=e:typeof e=="number"?this.setupString(e.toString()):this.setupString(e)}toFixed(e=0,n=!0){let i=this.toString();const s=e-this.getDecimalPrecision();return s>0?(i.includes(".")||(i+="."),i.padEnd(i.length+s,"0")):s<0?n?A(i,e):i.slice(0,s):i}toString(){let e=this.number.toString();if(this.decimal){let n=!1;return e.charAt(0)==="-"&&(e=e.substring(1),n=!0),e=e.padStart(e.length+this.decimal,"0"),e=`${e.slice(0,-this.decimal)}.${e.slice(-this.decimal)}`,e=$(e),(n?"-":"")+e}return e}lessThan(e){const[n,i]=this.adjustComparisonNumbers(e);return n<i}biggerThan(e){const[n,i]=this.adjustComparisonNumbers(e);return n>i}isEqual(e){const[n,i]=this.adjustComparisonNumbers(e);return n===i}setupString(e){if(e=$(e),F(e))this.number=BigInt(e);else if(I(e))this.decimal=V(e),this.number=BigInt(e.replace(".",""));else throw new Error(`BigNumber has received and invalid format for the constructor: ${e}`)}adjustComparisonNumbers(e){let n;e.constructor.name!=="BigNumber"?n=new N(e):n=e;const i=this.getDecimalPrecision()-n.getDecimalPrecision();let s=this.getNumber(),u=n.getNumber();return i>0?u=n.getNumber()*10n**BigInt(i):i<0&&(s=this.getNumber()*10n**BigInt(i*-1)),[s,u]}}function S(t,e=o,n=""){if(r(e,"utils format() - caller",n),r(e,"utils format() - input1",t),t==null)t="";else if(typeof t=="number")e.shouldRound?t=t.toFixed(m(e.precision)):t=t.toFixed(m(e.precision)+1).slice(0,-1);else if(e.modelModifiers&&e.modelModifiers.number&&F(t))t=Number(t).toFixed(m(e.precision));else if(!e.disableNegative&&t==="-")return t;r(e,"utils format() - input2",t);const i=e.disableNegative?"":t.indexOf("-")>=0?"-":"";let s=t.replace(e.prefix,"").replace(e.suffix,"");r(e,"utils format() - filtered",s),!e.precision&&e.thousands!=="."&&I(s)&&(s=A(s,0),r(e,"utils format() - !opt.precision && isValidFloat()",s));const u=E(s);r(e,"utils format() - numbers",u),r(e,"utils format() - numbersToCurrency",i+p(u,e.precision));const c=new N(i+p(u,e.precision));r(e,"utils format() - bigNumber1",c.toString()),e.max&&c.biggerThan(e.max)&&c.setNumber(e.max),e.min&&c.lessThan(e.min)&&c.setNumber(e.min);const d=c.toFixed(m(e.precision),e.shouldRound);if(r(e,"utils format() - bigNumber2",c.toFixed(m(e.precision))),/^0(\.0+)?$/g.test(d)&&e.allowBlank)return"";let[v,g]=d.split(".");const b=g!==void 0?g.length:0;v=v.padStart(e.minimumNumberOfCharacters-b,"0"),v=H(v,e.thousands);const B=e.prefix+K(v,g,e.decimal)+e.suffix;return r(e,"utils format() - output",B),B}function k(t,e=o,n=""){if(r(e,"utils unformat() - caller",n),r(e,"utils unformat() - input",t),!e.disableNegative&&t==="-")return r(e,"utils unformat() - return netagive symbol",t),t;const i=e.disableNegative?"":t.indexOf("-")>=0?"-":"",s=t.replace(e.prefix,"").replace(e.suffix,"");r(e,"utils unformat() - filtered",s);const u=E(s);r(e,"utils unformat() - numbers",u);const c=new N(i+p(u,e.precision));r(e,"utils unformat() - bigNumber1",u.toString()),e.max&&c.biggerThan(e.max)&&c.setNumber(e.max),e.min&&c.lessThan(e.min)&&c.setNumber(e.min);let d=c.toFixed(m(e.precision),e.shouldRound);return e.modelModifiers&&e.modelModifiers.number&&(d=parseFloat(d)),r(e,"utils unformat() - output",d),d}const T=(t,e,n)=>{if(r(e,"directive setValue() - caller",n),!W(e)){r(e,"directive setValue() - validateRestrictedOptions() return false. Stopping here...",t.value);return}let i=t.value.length-(t.selectionEnd||0);t.value=S(t.value,e,n),i=Math.max(i,e.suffix.length),i=t.value.length-i,i=Math.max(i,e.prefix.length),P(t,i),t.dispatchEvent(_("change"))},j=(t,e)=>{const n=t.currentTarget,i=t.code==="Backspace"||t.code==="Delete",s=n.value.length-(n.selectionEnd||0)===0;if(r(e,"directive onkeydown() - el.value",n.value),r(e,"directive onkeydown() - backspacePressed",i),r(e,"directive onkeydown() - isAtEndPosition",s),e.allowBlank&&i&&s&&k(n.value,e,"directive onkeydown allowBlank")===0&&(r(e,'directive onkeydown() - set el.value = ""',n.value),n.value="",n.dispatchEvent(_("change"))),r(e,"directive onkeydown() - e.key",t.key),t.key==="+"){r(e,"directive onkeydown() - unformat el.value",n.value);let u=k(n.value,e,"directive onkeydown +");typeof u=="string"&&(u=parseFloat(u)),u<0&&(n.value=String(u*-1))}},q=(t,e)=>{const n=t.currentTarget;r(e,"directive oninput()",n.value),/^[1-9]$/.test(n.value)&&(n.value=p(n.value,m(e.precision)),r(e,"directive oninput() - is 1-9",n.value)),T(n,e,"directive oninput")},U=(t,e)=>{const n=t.currentTarget;r(e,"directive onFocus()",n.value),e.focusOnRight&&P(n,n.value.length-e.suffix.length)},x={mounted(t,e){if(!e.value)return;const n=w({...o,...e.value});if(r(n,"directive mounted() - opt",n),t.tagName.toLocaleUpperCase()!=="INPUT"){const i=t.getElementsByTagName("input");i.length!==1||(t=i[0])}t.onkeydown=i=>{j(i,n)},t.oninput=i=>{q(i,n)},t.onfocus=i=>{U(i,n)},r(n,"directive mounted() - el.value",t.value),T(t,n,"directive mounted")},updated(t,e){if(!e.value)return;const n=w({...o,...e.value});t.onkeydown=i=>{j(i,n)},t.oninput=i=>{q(i,n)},t.onfocus=i=>{U(i,n)},r(n,"directive updated() - el.value",t.value),r(n,"directive updated() - opt",n),T(t,n,"directive updated")},beforeUnmount(t){t.onkeydown=null,t.oninput=null,t.onfocus=null}},Z=["id","value","disabled"],z={inheritAttrs:!1,name:"Money3",directives:{money3:x}},R=a.defineComponent({...z,props:{debug:{required:!1,type:Boolean,default:!1},id:{required:!1,type:[Number,String],default:()=>{const t=a.getCurrentInstance();return t?t.uid:null}},modelValue:{required:!0,type:[Number,String]},modelModifiers:{required:!1,type:Object,default:()=>({number:!1})},masked:{type:Boolean,default:!1},precision:{type:Number,default:()=>o.precision},decimal:{type:String,default:()=>o.decimal,validator(t){return y(t,"decimal")}},thousands:{type:String,default:()=>o.thousands,validator(t){return y(t,"thousands")}},prefix:{type:String,default:()=>o.prefix,validator(t){return y(t,"prefix")}},suffix:{type:String,default:()=>o.suffix,validator(t){return y(t,"suffix")}},disableNegative:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},max:{type:[Number,String],default:()=>o.max},min:{type:[Number,String],default:()=>o.min},allowBlank:{type:Boolean,default:()=>o.allowBlank},minimumNumberOfCharacters:{type:Number,default:()=>o.minimumNumberOfCharacters},shouldRound:{type:Boolean,default:()=>o.shouldRound},focusOnRight:{type:Boolean,default:()=>o.focusOnRight}},emits:["update:model-value"],setup(t,{emit:e}){const n=t,{modelValue:i,modelModifiers:s,masked:u,precision:c,shouldRound:d,focusOnRight:v}=a.toRefs(n);r(n,"component setup()",n);let g=i.value;(n.disableNegative||g!=="-")&&s.value&&s.value.number&&(d.value?g=Number(i.value).toFixed(m(c.value)):g=Number(i.value).toFixed(m(c.value)+1).slice(0,-1));const b=a.ref(S(g,n,"component setup"));r(n,"component setup() - data.formattedValue",b.value),a.watch(i,B);function B(h){r(n,"component watch() -> value",h);const f=S(h,w({...n}),"component watch");f!==b.value&&(r(n,"component watch() changed -> formatted",f),b.value=f)}let L=null;function J(h){let f=h.target.value;r(n,"component change() -> evt.target.value",f),u.value&&!s.value.number||(f=k(f,w({...n}),"component change")),f!==L&&(L=f,r(n,"component change() -> update:model-value",f),e("update:model-value",f))}const Q=a.useAttrs(),X=a.computed(()=>{const h={...Q};return delete h["onUpdate:modelValue"],h});return(h,f)=>{const Y=a.resolveDirective("money3");return a.withDirectives((a.openBlock(),a.createElementBlock("input",a.mergeProps({id:`${t.id}`},a.unref(X),{type:"tel",class:"v-money3",value:b.value,disabled:n.disabled,onChange:J}),null,16,Z)),[[Y,{precision:a.unref(c),decimal:n.decimal,thousands:n.thousands,prefix:n.prefix,suffix:n.suffix,disableNegative:n.disableNegative,min:n.min,max:n.max,allowBlank:n.allowBlank,minimumNumberOfCharacters:n.minimumNumberOfCharacters,debug:n.debug,modelModifiers:a.unref(s),shouldRound:a.unref(d),focusOnRight:a.unref(v)}]])}}}),G={install(t){t.component("money3",R),t.directive("money3",x)}};l.BigNumber=N,l.Money=R,l.Money3=R,l.Money3Component=R,l.Money3Directive=x,l.VMoney=x,l.VMoney3=x,l.default=G,l.format=S,l.unformat=k,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
